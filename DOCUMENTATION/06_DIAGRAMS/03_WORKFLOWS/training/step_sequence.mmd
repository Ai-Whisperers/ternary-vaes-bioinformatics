sequenceDiagram
    participant T as Trainer
    participant M as Model
    participant L as Loss
    participant O as Optimizer
    
    T->>M: forward(batch)
    M->>M: Encode -> Project
    M->>M: Compute Control
    M-->>T: Outputs + Control Ops
    T->>L: compute_loss(outputs, batch)
    L-->>T: Loss Dictionary
    T->>O: zero_grad()
    T->>O: backward()
    T->>O: step()
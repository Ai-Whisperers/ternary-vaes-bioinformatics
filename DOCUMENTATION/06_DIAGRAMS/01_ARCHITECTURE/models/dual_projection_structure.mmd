%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#2196f3', 'edgeLabelBackground':'#f9f9f9', 'tertiaryColor': '#e1e4e8'}} }%%
classDiagram
    classDef frozen fill:#e1e4e8,stroke:#333,stroke-dasharray: 5 5;
    classDef trainable fill:#c8e6c9,stroke:#2e7d32,stroke-width:2px;
    classDef hyperbolic fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px;
    
    note "Dual Projection"

    class DualHyperbolicProjection {
        +HyperbolicProjection proj_A
        +HyperbolicProjection proj_B
        +bool share_direction
        +forward(z_A, z_B)
    }
    class HyperbolicProjection:::hyperbolic {
        +DirectionNet direction_net
        +RadiusNet radius_net
        +forward(z) -> z_hyp
    }
    class DirectionNet:::trainable
    class RadiusNet:::trainable
    
    DualHyperbolicProjection *-- HyperbolicProjection
    HyperbolicProjection *-- DirectionNet
    HyperbolicProjection *-- RadiusNet